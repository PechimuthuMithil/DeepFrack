#
# The following constraints are not limitations of the hardware architecture,
# but help limit the search space to speed up search
#

mapspace_constraints:
  targets:
    # intuitive optimization to not tile the R and S dimension at the GLB level
    - target: GlobalBuffer
      type: temporal
      factors: 
      permutation: KQ
    # intuitive optimization to not tile the R and S dimension at the DRAM level
    - target: DRAM
      type: temporal
      factors: 
      permutation: KQ
    # intuitive optimization according to hardware dimension
    - target: PEAccuBuffer
      type: spatial
      factors: K=8
    # intuitive optimization according to hardware dimension
    - target: PEInputBuffer
      type: spatial
      factors: Q=8
    # The temporal constraints for the components below should together include all the dimensions of the problem
    # Each being responsible for a non-overlapping subset of them
    # responsible for P and Q
    - target: PEWeightRegs
      type: temporal
      permutation: KQ
      factors: K=1 Q=1
    # no temporal amplification
    - target: PEInputBuffer
      type: temporal
      factors: Q=1 K=1 P=1 
      permutation: PKQ
    # responsible for M
    - target: PEAccuBuffer
      type: temporal
      factors: P=1 K=1 
      permutation: PK
    # responsible for R and S
    - target: PEWeightBuffer
      type: temporal
      factors: P=1 Q=1 
      permutation: PQ
